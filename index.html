<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ERC20 Token balanceOf</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h1>Check ERC20 Token Balance</h1>
  <button id="checkBalance">Check My Token Balance</button>
  <p id="output">Click the button to see your token balance.</p>

  <script>
    const contractAddress = "0xa25231ad60b053609c46f883f7fba89301fa74fe";

    const erc20ABI = [
      "function balanceOf(address account) public view returns (uint256)"
    ];

    const output = document.getElementById("output");

    function getMetaMaskProvider() {
      if (window.ethereum?.providers) {
        return window.ethereum.providers.find(p => p.isMetaMask);
      }
      if (window.ethereum?.isMetaMask) {
        return window.ethereum;
      }
      return null;
    }

    document.getElementById("checkBalance").addEventListener("click", async () => {
      const metamask = getMetaMaskProvider();
      if (!metamask) {
        output.innerText = "MetaMask not found. Please install MetaMask.";
        return;
      }

      try {
        const accounts = await metamask.request({ method: "eth_requestAccounts" });
        const account = accounts[0].toLowerCase();

        const provider = new ethers.BrowserProvider(metamask);

        const network = await provider.getNetwork();
        if (network.chainId !== 17000n) {
          output.innerText = "Please switch to the Holesky Testnet in MetaMask.";
          return;
        }

        const token = new ethers.Contract(contractAddress, erc20ABI, provider);

        const balance = await token.balanceOf(account);
        const formattedBalance = ethers.formatUnits(balance, 18);

        output.innerText = `Your token balance: ${formattedBalance}`;
      } catch (err) {
        console.error(err);
        output.innerText = "‚ùå Error: " + err.message;
      }
    });
  </script>
</body>
</html>
